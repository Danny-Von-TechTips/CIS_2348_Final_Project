import csv
from datetime import datetime

class InventoryItem:
    def __init__(self, item_id, manufacturer, item_type, price, service_date, damaged=False):
        self.item_id = item_id
        self.manufacturer = manufacturer
        self.item_type = item_type
        self.price = price
        self.service_date = datetime.strptime(service_date, '%m/%d/%Y')
        self.damaged = damaged

'''Reading the CSV files and parsing the data'''
def read_csv(file_name):
    with open(file_name, mode='r') as file:
        csv_reader = csv.reader(file)
        data = [row for row in csv_reader]
    return data

def write_csv(file_name, data, headers=None):
    with open(file_name, mode='w', newline='') as file:
        csv_writer = csv.writer(file)
        if headers:
            csv_writer.writerow(headers)
        csv_writer.writerows(data)

def parse_manufacturer_list(data):
    items = {}
    for row in data:
        item_id = row[0]
        manufacturer = row[1]
        item_type = row[2]
        damaged = row[3] if len(row) > 3 else ''
        items[item_id] = InventoryItem(item_id, manufacturer, item_type, 0, '01/01/1900', damaged == 'damaged')
    return items

def parse_price_list(items, data):
    for row in data:
        item_id = row[0]
        price = float(row[1])
        if item_id in items:
            items[item_id].price = price

def parse_service_dates_list(items, data):
    for row in data:
        item_id = row[0]
        service_date = row[1]
        if item_id in items:
            items[item_id].service_date = datetime.strptime(service_date, '%m/%d/%Y')